# API Blueprint Language Server

Пакет позволяет более удобно работать с API Blueprint в редакторе VS Code.

## Возможности

* подсветка синтаксиса;
* переход к определению структур данных и Resource Prototypes;
* хлебные крошки;
* автодополнение.

## Работа с многофайловой документацией

Часто проекты содержат не один файл, а несколько. В этом случае можно
определить структуры данных в одном файле, а использовать их в другом. При
этом для корректной работы плагину необходимо знать корневой файл от которого
собирать документацию. В противном случае плагин не сможет понять какие
структуры данных являются корректными, а какие не определены.

По умолчанию, плагин пытается найти файл `doc.apib` в корне проекта и
использовать его в качестве корня. Если такой файл не найден, то документация
считается однофайловой.

Если в проекте в качестве корневого используется файл отличный от `doc.apib`,
то об этом можно сообщить плагину с помощью настройки:

File -> Prefernces -> Settings -> Extensions -> API Blueprint -> Entry Point

Если по каким-то причинам в файле не подсвечиваются ошибки, то первое, что надо
проверить — подключается ли данный файл прямо или опосредованно в корень
проекта.

## Структура пакета

```
├── client // Language Client
    └── extension.js // Language Client entry point
├── package.json // The extension manifest.
└── server // Language Server
    └── server.js // Language Server entry point
```

## Запуск для разработки

* в корневой директории выполнить команду `npm install`;
* открыть VS Code;
* переключиться в Debug viewlet;
* запустить `Launch Client`;
* открыть проект с APIB документацией или отдельный APIB-файл;
* запустить `Attach to Server`.

Вместо отдельных шагов `Launch Client` и `Attach to Server` можно использовать
команду `Client + Server`, но тогда APIB-файл нужно открывать достаточно
быстро, иначе команда `Attach to Server` завершится с ошибкой.

## Отладка

Для отладки сервера можно использовать точки останова и отладочный вывод.

Для отладочного вывода можно использовать функцию `connection.console.log`. При
этом результаты вывода необходимо искать в окне `Extension Development Host` в
панели `Output` - `API Blueprint Language Server`.

## Сборка пакета

* в корневой директории выполнить команду `npx vsce package`;
* полученный пакет передать для установки заинтересованным лицам.
